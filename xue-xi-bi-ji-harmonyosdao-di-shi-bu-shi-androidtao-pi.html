<!DOCTYPE html>
<html lang="zh" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>【学习笔记】HarmonyOS到底是不是Android套皮？ - 荆超的小站</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="/xue-xi-bi-ji-harmonyosdao-di-shi-bu-shi-androidtao-pi.html">

        <meta name="author" content="荆超" />
        <meta name="keywords" content="HarmonyOS" />
        <meta name="description" content="本文为学习笔记，并非原创。原文链接 HarmonyOS分析 原作者通过分析HarmonyOS应用的构建产物，得出如下结论： 1.构建产物中，包含一个标准Android的apk文件。该apk内AndroidManifest.xml文件中做了两件事： 1）定义Application为ShellApplication 2）定义MainActivity为MainAbilityShellActivity 2.ShellApplication最终继承自Android的Application。 3.MainAbilityShellActivity继承自Android的Activity。 原作者认为鸿蒙的分布式软总线是一个私有RPC协议。通过OpenHarmony源码分析，分布式软总线主要有以下几个模块： 设备发现：采用了CoAP协议作为设备发现协议，通过在一个局域网内发送广播来实现。 数据传输：基于Session提供统一的数据传输功能。 设备认证与管理：主要是安全。 AceEngineLite：应该就是JS开发的Ability页面如何编译以及 在嵌入式设备上如何渲染的相关实现，这也许就是为什么HarmonyOS可以采用多种开发语言开发界面的关键所在。各种小程序、Flutter相关设计都是这样的，设计思想都是：自创UI框架以屏蔽系统差异。 原作者认为，HarmonyOS = Android - GMS + HMS + 分布式软总线 + 以Ability为核心的应用开发框架，用图表示 …" />

        <meta property="og:site_name" content="荆超的小站" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="【学习笔记】HarmonyOS到底是不是Android套皮？"/>
        <meta property="og:url" content="/xue-xi-bi-ji-harmonyosdao-di-shi-bu-shi-androidtao-pi.html"/>
        <meta property="og:description" content="本文为学习笔记，并非原创。原文链接 HarmonyOS分析 原作者通过分析HarmonyOS应用的构建产物，得出如下结论： 1.构建产物中，包含一个标准Android的apk文件。该apk内AndroidManifest.xml文件中做了两件事： 1）定义Application为ShellApplication 2）定义MainActivity为MainAbilityShellActivity 2.ShellApplication最终继承自Android的Application。 3.MainAbilityShellActivity继承自Android的Activity。 原作者认为鸿蒙的分布式软总线是一个私有RPC协议。通过OpenHarmony源码分析，分布式软总线主要有以下几个模块： 设备发现：采用了CoAP协议作为设备发现协议，通过在一个局域网内发送广播来实现。 数据传输：基于Session提供统一的数据传输功能。 设备认证与管理：主要是安全。 AceEngineLite：应该就是JS开发的Ability页面如何编译以及 在嵌入式设备上如何渲染的相关实现，这也许就是为什么HarmonyOS可以采用多种开发语言开发界面的关键所在。各种小程序、Flutter相关设计都是这样的，设计思想都是：自创UI框架以屏蔽系统差异。 原作者认为，HarmonyOS = Android - GMS + HMS + 分布式软总线 + 以Ability为核心的应用开发框架，用图表示 …"/>
        <meta property="article:published_time" content="2021-06-09" />
            <meta property="article:section" content="学习笔记" />
            <meta property="article:tag" content="HarmonyOS" />
            <meta property="article:author" content="荆超" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="/theme/css/style.css" type="text/css"/>



</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <a href="/" class="navbar-brand">
荆超的小站            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<!-- Banner -->
<!-- End Banner -->

<!-- Content Container -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="/xue-xi-bi-ji-harmonyosdao-di-shi-bu-shi-androidtao-pi.html"
                       rel="bookmark"
                       title="Permalink to 【学习笔记】HarmonyOS到底是不是Android套皮？">
                        【学习笔记】HarmonyOS到底是不是Android套皮？
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2021-06-09T00:00:00+08:00"> 三 09 六月 2021</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="/tag/harmonyos.html">HarmonyOS</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <blockquote>
<p>本文为学习笔记，并非原创。<a href="https://mp.weixin.qq.com/s/RkJ_2WLf7MTL-f-kAOGxAw">原文链接</a></p>
</blockquote>
<h1>HarmonyOS分析</h1>
<p>原作者通过分析HarmonyOS应用的构建产物，得出如下结论：</p>
<p>1.构建产物中，包含一个标准Android的apk文件。该apk内AndroidManifest.xml文件中做了两件事：</p>
<p>1）定义Application为ShellApplication</p>
<p>2）定义MainActivity为MainAbilityShellActivity</p>
<p>2.ShellApplication最终继承自Android的Application。</p>
<p>3.MainAbilityShellActivity继承自Android的Activity。</p>
<p>原作者认为鸿蒙的<code>分布式软总线</code>是一个私有RPC协议。通过<a href="https://gitee.com/openharmony">OpenHarmony</a>源码分析，<code>分布式软总线</code>主要有以下几个模块：</p>
<ol>
<li>设备发现：采用了CoAP协议作为设备发现协议，通过在一个局域网内发送广播来实现。</li>
<li>数据传输：基于Session提供统一的数据传输功能。</li>
<li>设备认证与管理：主要是安全。</li>
<li><a href="https://gitee.com/openharmony/ace_engine_lite">AceEngineLite</a>：应该就是JS开发的Ability页面如何编译以及 在嵌入式设备上如何渲染的相关实现，这也许就是为什么HarmonyOS可以采用多种开发语言开发界面的关键所在。各种小程序、Flutter相关设计都是这样的，设计思想都是：自创UI框架以屏蔽系统差异。</li>
</ol>
<p>原作者认为，<strong>HarmonyOS = Android - GMS + HMS + 分布式软总线 + 以Ability为核心的应用开发框架</strong>，用图表示：</p>
<p><img alt="HarmonyOS" src="/images/2021/HarmonyOS.png"></p>
<p>原作者认为HarmonyOS在很长时间内无法剔除AOSP</p>
<h1>HarmonyOS能实现华为的目标吗？</h1>
<p>商业操作系统成功的因素主要有：系统优势、商业运作、生态建设。</p>
<h2>系统优势</h2>
<p>目前HarmonyOS有两个独有特性：</p>
<ol>
<li>
<p>一个跨平台的JavaScript应用框架（Ace Engine）</p>
</li>
<li>
<p>分布式软总线</p>
</li>
</ol>
<p>替换不了的几个部分：</p>
<ol>
<li>Linux Kernel：国内没人搞得定</li>
<li>AOSP：为了兼容Android应用</li>
<li>为什么Ability要交给AOSP去渲染：国内没人搞得定（计算机图形学）</li>
<li>为什么LiteOS的JS Framework都自己实现，但JS runtime还要用三星开源的JerryScript：国内搞不定（编译原理）</li>
</ol>
<h3>在IoT领域，两个独有部分可以形成技术壁垒吗？</h3>
<h4>操作系统</h4>
<p>物联网市面上的竞品有很多，除了华为的LiteOS外，还有TencentOS tiny、AliOS Things、Xiaomi Vela、RTOS……</p>
<p>LiteOS与其他相比最大的特点就是功能封装的更加友好，也更加统一，但最大的缺点也源于此：它需要的硬件资源太多了，对于绝大多数物联网设备来说，硬件成本是不可承受的。而如果裁剪掉这部分，那么和其他的IoT系统并没有太多区别。</p>
<h4>Ace Engine</h4>
<p>Ace Engine与小程序以及Flutter的设计思想与架构完全一样。 Flutter由于Dart虚拟机无法运行中资源有限的嵌入式设备中，所以在IoT领域不能成为竞争对手。</p>
<p>微信小程序支持Android、IOS、HarmonyOS（由于兼容Android），而且有WMPF（Wechat Mini-Program Framework，小程序硬件框架）的存在。目前微信小程序也可以运行在Windows、Mac、嵌入式设备上，基本覆盖了Ace Engine的所有设备（HarmonyOS、嵌入式设备）以及Ace Engine不支持的设备（IOS、Mac、Windows）。</p>
<h4>分布式软总线</h4>
<p>有众多开源和其他厂商。</p>
<p>微信小程序的优势：</p>
<ul>
<li>在微信小程序中做物联网应用，可以支持更多的平台（HarmonyOS vs Android+IOS）</li>
<li>在微信小程序中做物联网应用，开发成本更低（小程序 vs App）</li>
<li>在微信小程序中做物联网应用，推广成本更低（微信小程序生态 vs 华为App生态）</li>
<li>在微信小程序中做物联网应用，获客成本更低（即开即用 vs 下载、安装App）</li>
</ul>
<p>HarmonyOS的优势仅在于，系统内的RPC(分布式软总线)性能要比应用内RPC好。</p>
<p>如果<code>分布式软总线</code>这条路是无价值的，那么作为HarmonyOS最大的卖点，HarmonyOS所做的种种努力都是白费的。而如果<code>分布式软总线</code>这条路走得通，极其容易被别的厂商参考、借鉴，HarmonyOS却并不能以此建立足够宽广的「护城河」并以此培育出自己的生态。</p>
<h2>商业运作</h2>
<p>一款商业操作系统想要生存，最基本的条件有两个：</p>
<ul>
<li>足够多的用户</li>
<li>可以平衡厂家、用户、开发者利益的政策。死于这个因素的操作系统最著名的就是Windows Phone，一意孤行、反复横跳，导致微软错失了整个移动互联网时代。</li>
</ul>
<p>在成功之前，也就只有华为和荣耀会搭载HarmonyOS。以两年换机周期为例，目前华为手机存量大约为4亿台，国内大概2.5亿台。在2020年9月15日之后，被禁止生产5nm Kirin芯片之后，华为终端产品缺货的状态持续存在，华为国内的市场份额估计也会快速萎缩。所以，达不到第一个条件。</p>
<p>在商业政策方面，华为整体的态度是开放的（老板的态度）。但到了执行层面，就变成了华为优先（余总的态度）。在第三方应用方面，一方面表示每一位开发者都是华为要汇聚的星星之火。另一方面执行起来，却是只和大厂合作。在2021年这个时间点，作为还有不到一个月就要发布的且宣称要开源的新系统，到现在为止还像宝贝一样藏起来、对非核心开发者像防贼一样，技术实现细节语焉不详，虚拟机云端运行，开发文档只有UI和分布式软总线两部分，其他部分依旧是在Android上的HMS SDK。</p>
<h2>生态环境建设</h2>
<p>在海外，GMS具有垄断地位，HMS+华为硬件暂时不具备与之竞争的能力。</p>
<p>在国内，由于Google服务在国内被禁，又由于GMS这个框架确实没有什么技术壁垒，又由于HMOV四家手机厂商除了华为独有芯片设计能力之外，在手机设计方面各家技术实力相差不大，所以各家都实现了一套类似GMS的框架：</p>
<ul>
<li>https://developer.huawei.com/consumer/cn/</li>
<li>https://dev.mi.com/console/</li>
<li>https://open.oppomobile.com/</li>
<li>https://dev.vivo.com.cn/home?cid=w-2-baidu-sem-kfpt-qt</li>
</ul>
<p>HMOV一个不落，全都提供类似的移动服务，如果你点开看一下，发现他们提供的服务内容也相差不大。所以在国内，HMS、MMS、OMS、VMS的市场份额就约等于它们手机的市场份额，所以腾讯系、阿里系接入HMS并不会给HMS提供什么额外竞争力，因为它们接入华为家的HMS，自然也会同时接入小米家的MMS、OPPO家的OMS、Vivo家的VMS。而且它们接入的基本上只有推送服务，像比较重要的账号体系、支付体系都会牢牢把握在自己手中，甚至即使是推送服务，它们为了保证自己的业务以及消息送达率，它们在接入官方推送服务后依旧在后台维护这自己独有的推送服务，那些应用互启动、推送服务后台耗电问题依旧没有解决。</p>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'jingchao'; // required: replace example with your forum shortname

            var disqus_config = function () {
                this.language = "zh";

                        this.page.identifier = '2021-06-09-xue-xi-bi-ji-harmonyosdao-di-shi-bu-shi-androidtao-pi';
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="https://www.linkedin.com/in/chao-jing-8470a895/"><i class="fa fa-linkedin-square fa-lg"></i> LinkedIn</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Recent Posts -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
  <ul class="list-group" id="recentposts">
    <li class="list-group-item"><a href="/xue-xi-bi-ji-wkwebview-jia-zai-sheng-ming-zhou-qi-yu-dai-li-fang-fa-pou-xi.html">【学习笔记】WKWebView 加载生命周期与代理方法剖析</a></li>
    <li class="list-group-item"><a href="/iosji-zhu-wen-zhang-lie-biao.html">iOS技术文章列表</a></li>
    <li class="list-group-item"><a href="/xue-xi-bi-ji-zheng-jing-fen-xi-iosbao-da-xiao-you-hua.html">【学习笔记】正经分析iOS包大小优化</a></li>
    <li class="list-group-item"><a href="/xue-xi-bi-ji-shou-ba-shou-jiao-ni-debug-ios-14-imageio-crash-fen-xi.html">【学习笔记】手把手教你 Debug — iOS 14 ImageIO Crash 分析</a></li>
    <li class="list-group-item"><a href="/xue-xi-bi-ji-harmonyosdao-di-shi-bu-shi-androidtao-pi.html">【学习笔记】HarmonyOS到底是不是Android套皮？</a></li>
  </ul>
</li>
<!-- End Sidebar/Recent Posts -->

<!-- Sidebar/Categories -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Categories</span></h4>
  <ul class="list-group" id="categories">
    <li class="list-group-item">
      <a href="/category/blog.html"><i class="fa fa-folder-open fa-lg"></i>Blog</a>
    </li>
    <li class="list-group-item">
      <a href="/category/fan-yi.html"><i class="fa fa-folder-open fa-lg"></i>翻译</a>
    </li>
    <li class="list-group-item">
      <a href="/category/wen-zhang-lie-biao.html"><i class="fa fa-folder-open fa-lg"></i>文章列表</a>
    </li>
    <li class="list-group-item">
      <a href="/category/xue-xi-bi-ji.html"><i class="fa fa-folder-open fa-lg"></i>学习笔记</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Categories -->

<!-- Sidebar/Tag Cloud -->
<li class="list-group-item">
  <a href="/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
  <ul class="list-group " id="tags">
    <li class="list-group-item tag-1">
      <a href="/tag/ios.html">iOS</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="/tag/xing-neng.html">性能</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="/tag/harmonyos.html">HarmonyOS</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="/tag/bao-ti-ji.html">包体积</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="/tag/git.html">git</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="/tag/yin-shi-pin.html">音视频</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="/tag/crash.html">Crash</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="/tag/liu-lan-qi.html">浏览器</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="/tag/jian-kong.html">监控</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Tag Cloud -->

<!-- Sidebar/Links -->
<li class="list-group-item">
  <h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
  <ul class="list-group" id="links">
    <li class="list-group-item">
      <a href="http://hutaow.com/" target="_blank">胡桃夹子</a>
    </li>
    <li class="list-group-item">
      <a href="http://wenzhong.me/" target="_blank">Wenzhong's Playground</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Links -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2021 荆超
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="/theme/js/respond.min.js"></script>


    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'jingchao'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->


</body>
</html>